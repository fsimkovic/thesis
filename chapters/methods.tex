
\section{Datasets}
\subsection{FLUME dataset} \label{sec:methods_flume_dataset}
A test set of 21 globular protein targets was manually selected to include a range of chain lengths, fold architectures, X-ray diffraction data resolutions and \gls{msa} depths for contact prediction  (\cref{table:methods_flume_dataset}). The test set covered the three fold classes (\textalpha-helical, mixed \textalpha-\textbeta\ and \textbeta-sheet) and targets were grouped using their DSSP \cite{Kabsch1983-dy} secondary-structure assignment. Target chain lengths fell in the range of [62, 221] residues. Each crystal structure contained one molecule per asymmetric unit and the resolutions of the experimental data was in range from 1.0 to 2.3\AA.

\begin{sidewaystable}
	\footnotesize
	\centering
	\caption{Summary of the FLUME dataset.}
	\label{table:methods_flume_dataset}
	\begin{tabularx}{\textheight}{ t b t t t t t t t s t }
		\hline
		\textbf{\gls{pdb} ID} & \textbf{Molecule}	& \textbf{Resolution (\AA)}	& \textbf{Space Group}	& \textbf{Chain ID}	& \textbf{Chain Length}	& \textbf{Molecules per ASU}	& \textbf{Matthew's Coefficient}	& \textbf{Solvent Content (\%)}	& \textbf{Fold}	& \textbf{Citation}	\\
		\hline
		1a6m		&	Oxy-myoglobin											&	1.00		&	P$2_1$			& A	&	151	&	1	&	1.90		&	36.00	&	all-\textalpha				& \cite{Vojtechovsky1999-oi}	\\
		1aba		&	T4 glutaredoxin											&	1.45		&	P$2_1 2_1 2_1$	& A	&	87	&	1	&	2.22		&	44.62	&	mixed \textalpha/\textbeta	& \cite{Eklund1992-bj}			\\
		1bdo		&	Biotinyl domain of acetyl-coenzyme A carboxylase		&	1.80		&	P$2_1 2_1 2$	& A	&	80	&	1	&	2.48		&	49.00	&	all-\textbeta				& \cite{Athappilly1995-pz}		\\
		1bkr		&	Calponin Homology (CH) domain from \textbeta-spectrin	&	1.10		&	P$2_1$			& A	&	109	&	1	&	2.04		&	39.80	&	all-\textalpha				& \cite{Banuelos1998-bz}		\\
		1chd		&	CheB methylesterase domain								&	1.75		&	P$3_2 2 1$		& A	&	203	&	1	&	2.35		&	47.65	&	mixed \textalpha/\textbeta	& \cite{West1995-sz}			\\
		1e0s		&	G-protein Arf6-GDP										&	2.28		&	P$6_1 2 2$		& A	&	174	&	1	&	2.18		&	37.00	&	mixed \textalpha/\textbeta	& \cite{Menetrey2000-rk}		\\
		1eaz		&	Phosphoinositol (3,4)-bisphosphate PH domain			&	1.40		&	C$2 2 2_1$		& A	&	125	&	1	&	2.48		&	48.00	&	mixed \textalpha+\textbeta	& \cite{Thomas2001-hz}			\\
		1hh8		&	N-terminal region of P67Phox							&	1.80		&	P$3_1$			& A	&	213	&	1	&	2.71		&	45.00	&	all-\textalpha				& \cite{Grizot2001-wt}			\\
		1kjl		&	Galectin-3 domain										&	1.40		&	P$2_1 2_1 2_1$	& A	&	146	&	1	&	2.15		&	42.68	&	all-\textbeta				& \cite{Sorme2005-hh}			\\
		1kw4		&	Polyhomeotic SAM domain									&	1.75		&	P$6_5$			& A	&	89	&	1	&	2.25		&	45.27	&	all-\textalpha				& \cite{Kim2002-kl}				\\
		1lo7		&	4-hydroxybenzoyl CoA thioesterase						&	1.50		&	I$2 2 2$		& A	&	141	&	1	&	2.06		&	40.22	&	mixed \textalpha+\textbeta	& \cite{Thoden2002-bl}			\\
		1npu		&	Extracellular domain of murine PD-1						&	2.00		&	P$2_1 2_1 2_1$	& A	&	117	&	1	&	1.67		&	25.80	&	all-\textbeta				& \cite{Zhang2004-zt}			\\
		1pnc		&	Poplar plastocyanin										&	1.60		&	P$2_1 2_1 2_1$	& A	&	99	&	1	&	1.82		&	32.48	&	all-\textbeta				& \cite{Fields1994-ab}			\\
		1tjx		&	Synaptotagmin I C2B domain								&	1.04		&	P$3_2 2 1$		& A	&	159	&	1	&	2.40		&	48.00	&	mixed \textalpha+\textbeta	& \cite{Cheng2004-bg}			\\
		1tlv		&	LicT PRD												&	1.95		&	P$3_2 2 1$		& A	&	221	&	1	&	2.80		&	50.00	&	all-\textalpha				& \cite{Graille2005-di}			\\
		2nuz		&	\textalpha-spectrin SH3 domain							&	1.85		&	P$2_1 2_1 2_1$	& A	&	62	&	1	&	2.57		&	52.16	&	all-\textbeta				&								\\
		2qyj		&	Ankyrin													&	2.05		&	P$6_1$			& A	&	166	&	1	&	2.28		&	45.99	&	all-\textalpha				& \cite{Merz2008-gu}			\\
		3w56		&	C2 domain					 							&	1.60		&	I$2$			& A	&	131	&	1	&	2.05		&	40.10	&	all-\textbeta				& \cite{Traore2013-jy}			\\
		4cl9		&	N-terminal bromodomain of Brd4							&	1.40		&	P$2_1 2_1 2_1$	& A	&	127	&	1	&	2.21		&	44.37	&	all-\textalpha				& \cite{Atkinson2014-he}		\\
		4u3h		&	FN3con													&	1.98		&	P$4_1 3 2$		& A	&	100	&	1	&	2.47		&	50.27	&	all-\textbeta				& \cite{Porebski2015-hc}		\\
		4w97		&	KstR2 													&	1.60		&	C$2$			& A	&	200	&	1	&	2.75		&	55.25	&	all-\textalpha				& \cite{Crowe2015-hm}			\\
		\hline
	\end{tabularx}
\end{sidewaystable}

\subsection{KEENO dataset} \label{sec:methods_keeno_dataset}
An unbiased selection of 27 non-redundant protein targets was selected using the following protocol (\cref{table:methods_keeno_dataset}).

The Pfam v29.0 \cite{Finn2016-tz} database was filtered for all protein families with at least one representative structure in the RCSB \gls{pdb} \cite{Berman2000-qj} database. Each representative had to have monomeric protein stoichiometry and its fold classified in the SCOPe v2.05 database \cite{Chandonia2017-bd}. Targets with fold assignments other than "a" (all-\textalpha), "b" (all-\textbeta), "c" (mixed \textalpha+\textbeta) or "d" (mixed \textalpha/\textbeta) were excluded to exclusively focus on regular globular protein folds. Each resulting protein target was screened against the RESTful API of the RCSB \gls{pdb} (\url{www.rcsb.org}) webserver to identify targets meeting the following criteria: experimental technique is X-ray crystallography; chain length is $\geq100$ residues and $\leq250$ residues; resolution is between 1.3 and 2.3\AA; structure factor amplitudes are deposited in the Protein Data Bank \cite{Berman2000-qj} database; and there is only a single molecule in the asymmetric unit. The resulting protein structures were cross-validated against the \gls{pdbtm} \cite{Tusnady2005-lp} to exclude any possible matches. Subsequently, one representative entry was randomly selected for each Pfam family.

The final set of 27 non-redundant targets was determined using further target characterisation and grouping of Pfam families. All targets were grouped using three criteria: domain fold, target chain length and alignment depth. The former consisted of the three fold classes all-\textalpha, all-\textbeta, and mixed \textalpha-\textbeta\ (\textalpha+\textbeta\ and \textalpha/\textbeta) and targets were group using the SCOPe assignment. The target chain lengths were obtained from the deposited information via the RESTful API of the RCSB \gls{pdb} web server and split into three bins, using 150 and 200 residues as bin edges. Furthermore, the alignment depth was calculated for the sequence alignment of each Pfam family and three bins established with bin edges of 100 and 200 sequences. Thus, all targets were classed in three bins for each of the three features. 

The final selection of the 27 targets was performed by randomly selecting one target for each feature combination. To ensure even sampling across the three different fold categories, a target function was employed to identify roughly even target characteristics in each group. The alignment depth and chain length were used as metrics, and had to be within $\pm15$ units to the values of the other fold classes. This created two conditions that had to be met for a randomly chosen sample to be accepted.

\begin{sidewaystable}
	\footnotesize
	\centering
	\caption{Summary of the KEENO dataset.}
	\label{table:methods_keeno_dataset}
	\begin{tabularx}{\textheight}{ t b t t t t t t t s t }
		\hline
		\textbf{\gls{pdb} ID} & \textbf{Molecule}	& \textbf{Resolution (\AA)}	& \textbf{Space Group}	& \textbf{Chain ID}	& \textbf{Chain Length}	& \textbf{Molecules per ASU}	& \textbf{Matthew's Coefficient}	& \textbf{Solvent Content (\%)}	& \textbf{Fold}	& \textbf{Citation}	\\
		\hline
		1fcy		& Retinoic acid nuclear receptor HRAR						& 1.30	& P$4_1 2_1 2$		& A	& 236	& 1	& 2.25	& 45.50	&	all-\textalpha				& \cite{Klaholz2000-rd}		\\
		1fvg		& Peptide methionine sulfoxide reductase					& 1.60	& C$1 2 1$			& A	& 199	& 1	& 2.10	& 41.55	&	mixed \textalpha+\textbeta	& \cite{Lowther2000-ik}		\\	
		1gm4		& Cytochrome C3												& 2.05	& P$6_1 2 2$		& A	& 107	& 1	& 2.48	& 50.43	&	all-\textalpha				& \cite{Louro2001-cq}		\\
		1gv8		& N-II domain of ovotransferrin								& 1.95	& P$3_1$			& A	& 159	& 1	& 2.24	& 45.00	&	mixed \textalpha/\textbeta	& \cite{Kuser2002-pr}		\\
		1k40		& FAT domain of focal adhesion kinase						& 2.25	& C$1 2 1$			& A	& 126	& 1	& 2.21	& 44.40	&	all-\textalpha				& \cite{Hayashi2002-dc}		\\
		1oee		& Hypothetical protein YodA 								& 2.10	& C$1 2 1$			& A	& 193	& 1	& 2.30	& 46.20	&	all-\textbeta				& \cite{David2003-rb}		\\
		1oz9		& Hypothetical protein AQ\_1354								& 1.89	& P$4_3 2_1 2$		& A	& 150	& 1	& 2.76	& 55.07	&	mixed \textalpha+\textbeta	& \cite{Oganesyan2003-gc}	\\
		1q8c		& Hypothetical protein MG027								& 2.00	& P$4_1$			& A	& 151	& 1	& 2.42	& 49.25	&	all-\textalpha				& \cite{Liu2004-ce}			\\
		1rlh		& Conserved hypothetical protein							& 1.80	& P$6_3$			& A	& 173	& 1	& 2.12	& 41.98	&	mixed \textalpha+\textbeta	&							\\
		1s2x		& Cag-Z														& 1.90	& P$2_1 2_1 2_1$	& A	& 206	& 1	& 2.74	& 54.70	&	all-\textalpha				& \cite{Cendron2004-jl}		\\
		1u61		& Putative Ribonuclease III									& 2.15	& I$4_1 3 2$		& A	& 138	& 1	& 6.50	& 80.80	&	all-\textalpha				&							\\
		1zxu		& At5g01750 protein											& 1.70	& P$2_1 2_1 2_1$	& A	& 217	& 1	& 2.50	& 50.20	&	mixed \textalpha+\textbeta	&							\\
		2eum		& Glycolipid transfer protein								& 2.30	& C$1 2 1$			& A	& 209	& 1	& 2.25	& 45.39	&	all-\textalpha				& \cite{Malinina2006-ba}	\\
		2ol8		& Outer surface protein A									& 1.90	& P$1 2_1 1$		& O	& 249	& 1	& 2.19	& 43.87	&	all-\textbeta				& \cite{Makabe2007-fr}		\\
		2oqz		& Sortase B													& 1.60	& P$1 2_1 1$		& A	& 223	& 1	& 2.07	& 40.71	&	all-\textbeta				& \cite{Maresso2007-sm}		\\
		2x6u		& T-Box transcription factor TBX5							& 1.90	& P$2_1 2_1 2_1$	& A	& 203	& 1	& 2.20	& 44.21	&	all-\textbeta				& \cite{Stirnimann2010-mm}	\\
		2y64		& Xylanase													& 1.40	& P$2_1 2_1 2_1$	& A	& 167	& 1	& 2.15	& 43.00	&	all-\textbeta				& \cite{Von_Schantz2012-rh}	\\
		2yjm		& TtrD														& 1.84	& C$1 2 1$			& A	& 176	& 1	& 2.08	& 40.80	&	all-\textalpha				& \cite{Coulthurst2012-cm}	\\
		2yq9		& 2, 3-cyclic-nucleotide 3-phosphodiesterase				& 1.90	& P$2_1 2_1 2_1$	& A	& 221	& 1	& 2.10	& 41.70	&	mixed \textalpha+\textbeta	& \cite{Myllykoski2013-wf}	\\
		3dju		& Protein BTG2												& 2.26	& P$2_1 2_1 2_1$	& B	& 122	& 1	& 1.98	& 37.73	&	mixed \textalpha+\textbeta	& \cite{Yang2008-iu}		\\
		3g0m		& Cysteine desulfuration protein sufE						& 1.76	& P$1 2_1 1$		& A	& 141	& 1	& 1.88	& 34.58	&	mixed \textalpha+\textbeta	&							\\
		3qzl		& Iron-regulated surface determinant protein A				& 1.30	& P$2_1 2_1 2$		& A	& 127	& 1	& 2.42	& 49.12	&	all-\textbeta				& \cite{Grigg2011-jh}		\\
		4aaj		& N-(5-phosphoribosyl)anthranilate isomerase				& 1.75	& P$6_1$			& A	& 228	& 1	& 2.38	& 48.30	&	mixed \textalpha/\textbeta	& \cite{Repo2012-nc}		\\
		4dbb		& Amyloid-\textbeta\ A4 precursor protein-binding family A1	& 1.90	& P$4_1 2_1 2$		& A	& 162	& 1	& 3.25	& 62.10	&	all-\textbeta				& \cite{Matos2012-wq}		\\
		4e9e		& Methyl-CpG-binding domain protein 4						& 1.90	& H$3$				& A	& 161	& 1	& 2.42	& 49.23	&	all-\textalpha				& \cite{Morera2012-pd}		\\
		4lbj		& Galectin-3												& 1.80	& P$2_1 2_1 2_1$	& A	& 138	& 1	& 2.09	& 41.01	&	all-\textbeta				& \cite{Collins2014-jb}		\\
		4pgo		& Hypothetical protein PF0907								& 2.30	& P$6_5 2 2$		& A	& 116	& 1	& 3.25	& 62.10	&	all-\textbeta				& \cite{Weinert2015-te}		\\
		\hline
	\end{tabularx}
\end{sidewaystable}

\subsection{ETHERWOOD dataset} \label{sec:methods_etherwood_dataset}

The selection of this dataset was done by Dr. Jens MH Thomas. The following extract from \cite{Thomas2017-lq} outlines the selection process.

\begin{displayquote}
	A set of 14 transmembrane protein structures was selected by firstly generating a list of all the \textalpha-helical proteins from the \gls{pdbtm} \cite{Tusnady2005-lp}. An advanced query was run against the \gls{pdb} to extract all structures corresponding to the \gls{pdbtm} list but containing a single protein entity (regardless of the number of copies in the crystallographic asymmetric unit), with a sequence length $<250$ and where the structure was resolved to a resolution of $<2.5$\AA. The resuluting selection was clustered with CD-HIT \cite{Li2006-kw} using a sequence-identity threshold of 0.4 and a word length of 2. For each cluster with more than one structure, the shortest, highest resolution structure was selected where there was a viable experimental dataset available. Structures with a chain length of $<30$ residues or $<800$ residues in the asymmetric unit were selected to create the final set. 
\end{displayquote}

\begin{sidewaystable}
	\footnotesize
	\centering
	\caption{Summary of the ETHERWOOD dataset.}
	\label{table:methods_keeno_dataset}
	\begin{tabularx}{\textheight}{ t b t t t t t t t s t }
		\hline
		\textbf{\gls{pdb} ID} & \textbf{Molecule}	& \textbf{Resolution (\AA)}	& \textbf{Space Group}	& \textbf{Chain ID}	& \textbf{Chain Length}	& \textbf{Molecules per ASU}	& \textbf{Matthew's Coefficient}	& \textbf{Solvent Content (\%)}	& \textbf{Fold}	& \textbf{Citation}	\\
		\hline
		1gu8	& Sensory rhodopsin II					& 2.27	& C$2 2 2_1$	& A	& 239	& 1	& 2.75	& 53.00	&	all-\textalpha	& \cite{Edman2002-qb}		\\
		2bhw	& Chlorophyll A-B binding protein AB80	& 2.50	& C$1 2 1$		& A	& 232	& 3	& 4.10	& 69.00	&	all-\textalpha	& \cite{Standfuss2005-bd}	\\
		2evu	& Aquaporin aqpM						& 2.30	& I$4$			& A	& 246	& 1	& 3.38	& 63.57	&	all-\textalpha	& \cite{Lee2005-uu}			\\
		2o9g	& Aquaporin Z							& 1.90	& I$4$			& A	& 234	& 1	& 3.34	& 63.19	&	all-\textalpha	& \cite{Savage2007-bn}		\\
		2wie	& ATP synthase C chain					& 2.13	& P$6_3 2 2$	& A	& 82	& 5	& 3.41	& 68.00	&	all-\textalpha	& \cite{Pogoryelov2009-pq}	\\
		2xov	& Rhomboid protease GLPG				& 1.65	& H$3 2$		& A	& 181	& 1	& 3.50	& 64.92	&	all-\textalpha	& \cite{Vinothkumar2010-up}	\\
		3gd8	& Aquaporin 4							& 1.80	& P$4 2_1 2$	& A	& 223	& 1	& 2.73	& 54.97	&	all-\textalpha	& \cite{Ho2009-zg}			\\
		3hap	& Bacteriorhodopsin						& 1.60	& C$2 2 2_1$	& A	& 249	& 1	& 2.73	& 54.99	&	all-\textalpha	& \cite{Joh2009-vb}			\\
		3ldc	& Calcium-gated potassium channel mthK	& 1.45	& P$4 2_1 2$	& A	& 82	& 1	& 2.48	& 50.44	&	all-\textalpha	& \cite{Ye2010-th}			\\
		3ouf	& Potassium channel protein				& 1.55	& I$2$			& A	& 97	& 2	& 2.40	& 48.76	&	all-\textalpha	& \cite{Derebe2011-yf}		\\
		3pcv	& Leukotriene C4 synthase				& 1.90	& F$2 3$		& A	& 156	& 1	& 4.91	& 74.77	&	all-\textalpha	& \cite{Saino2011-ip}		\\
		3rlb	& ThiT									& 2.00	& C$1 2 1$		& A	& 192	& 2	& 3.89	& 68.39	&	all-\textalpha	& \cite{Erkens2011-hj}		\\
		3u2f	& ATP synthase subunit C				& 2.00	& P$4_2 2 2$	& K	& 76	& 5	& 2.32	& 46.92	&	all-\textalpha	& \cite{Symersky2012-ir}	\\
		4dve	& Biotin transporter BioY				& 2.09	& C$1 2 1$		& A	& 198	& 3	& 3.27	& 62.40	&	all-\textalpha	& \cite{Berntsson2012-ih}	\\
		\hline
	\end{tabularx}
\end{sidewaystable}


\section{Statistics}
\textcolor{red}{This bit will almost certainly be moved to a better home ...}
\subsection{Alignment depth} \label{sec:methods_alignment_depth}
\begin{equation} 
N_{eff}=\sum_{i}\frac{1}{\sum_{j}S_{i,j}}
\label{eq:methods_alignment_depth}
\end{equation}


\subsection{Precision} \label{sec:methods_precision}
The precision of a contact prediction is calculated by dividing the number of true positive (TP) contact pairs by the number of false positive (FP) ones. To determine if a given contact in a prediction is either true or false positive, contact pairs are compared to those contacts extracted from a reference protein structure. Two residues in a protein structure are considered to be in contact if their C\textbeta\ atoms (C\textalpha\ in case of Gly) are $<8$\AA\ apart.

\begin{equation} 
Prec = \frac{TP}{TP-FP}
\label{eq:methods_precision}
\end{equation}

\subsection{Jaccard index} \label{sec:methods_jaccard_idx}
The Jaccard index describes the similarity between two contact predictions by the proportion of contact pairs in the intersection compared to the union of the two predictions. The Jaccard index is calculated using \cref{eq:methods_jaccard_index}.

\begin{equation} 
J_{x,y}=\frac{\left |x \cap y\right |}{\left |x \cup y\right |}
\label{eq:methods_jaccard_index}
\end{equation}

The variables $x$ and $y$ are two sets of contact pairs. $\left |x \cap y\right |$ is the number of elements in the intersection of $x$ and $y$, and the $\left |x \cup y\right |$ represents the number of elements in the union of $x$ and $y$.

The Jaccard index falls in the range [0,1], with a value of 1 corresponding to identical sets of contact pairs and 0 to non-identical ones. It is worth noting that only exact matches are considered and the neighbourhood of a single contact ignored.

\subsection{Singleton contacts} \label{sec:methods_singleton_contacts}
\subsection{\acrlong{rmsd}} \label{sec:methods_rmsd}
\subsection{\acrlong{tmscore}} \label{sec:methods_tmscore}
The \gls{tmscore} is a metric to assess the similarity between two protein structures. Unlike the \gls{rmsd}, which is easily misled by major deviations in few parts between the two structures, the \gls{tmscore} assesses the global topology between the two folds more accurately \cite{Zhang2005-hx}. The key difference in achieving this is the weighting of the distances. The \gls{rmsd} weights all distances equally; in contrast, the \gls{tmscore} has a length-dependent weighting with shorter distances between residues obtaining stronger weights \cite{Zhang2005-hx}.

\begin{equation} \label{eq:methods_tmscore}
TMscore=\frac{1}{L}\left [ \sum_{i=1}^{L_{ali}}\frac{1}{1+\left (\frac{d_i}{d_0}\right )^2}\right ]_{max}
\end{equation}

\begin{equation} \label{eq:methods_tmscore_constant}
d_0=1.24*\sqrt[3]{L-15}-1.8
\end{equation}

In \cref{eq:methods_tmscore,}, $L$ is the length of the target protein and $L_{ali}$ the number of equivalent residues in the two protein structures. $di$ is the distance of the \textit{ith} pair of the equivalent residues between the two structures and depends on the superposition matrix. The $max$ term refers to the procedure which attempts to identify the optimal superposition matrix to maximize the sum. The scale factor $d0$ is introduced to normalise the TM-score so that the magnitude of the average \gls{tmscore} for random protein pairs is independent on the size of the proteins \cite{Zhang2005-hx}.

The \gls{tmscore} always falls in range of (0, 1], whereby higher values correlate to higher degrees of similarity between the two protein structures. A \gls{tmscore} of $<0.17$ indicates that two structures have no similarity between them, whereas a value of $\geq0.50$ typically describes the same fold \cite{Xu2010-sw}.

\subsection{\acrlong{rio}} \label{sec:methods_rio}
The RIO score counts the number of C\textalpha atoms in the \gls{mr} result that are within 1.5\AA\ of a C\textalpha atom in the crystal structure (regardless of how the C\textalpha\ atoms are related in sequence), including only stretches where at least three consecutive C\textalpha\ atoms of the \gls{mr} result overlie matching C\textalpha atoms in the deposited structure. This quantifies how well the \gls{mr} result maps onto the crystal structure, without making any assumptions about the correctness of the model or the placement with respect to register. The total \gls{rio} score is composed of an in-register (i.e. residues in the placed \gls{mr} search model correctly overlay their counterparts in the crystal structure) $RIO_{in}$ component and a second $RIO_{out}$ component summing out-of-register overlays.
